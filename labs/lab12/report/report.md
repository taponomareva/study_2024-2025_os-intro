---
## Front matter
title: "Отчёт по лабораторной работе №12"
subtitle: "Операционные системы"
author: "Пономарева Татьяна Александровна"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Изучить основы программирования в оболочке ОС UNIX/Linux. Научиться писать небольшие командные файлы.

# Задание

Здесь приводится описание задания в соответствии с рекомендациями
методического пособия и выданным вариантом.

# Теоретическое введение

Командный процессор (командная оболочка, интерпретатор команд shell) — это программа, позволяющая пользователю взаимодействовать с операционной системой компьютера. В операционных системах типа UNIX/Linux наиболее часто используются следующие реализации командных оболочек:

– оболочка Борна (Bourne shell или sh) — стандартная командная оболочка UNIX/Linux, содержащая базовый, но при этом полный набор функций;
– С-оболочка (или csh) — надстройка над оболочкой Борна, использующая С-подобный синтаксис команд с возможностью сохранения истории выполнения команд;
– оболочка Корна (или ksh) — напоминает оболочку C, но операторы управления программой совместимы с операторами оболочки Борна;
– BASH — сокращение от Bourne Again Shell (опять оболочка Борна), в основе своей совмещает свойства оболочек C и Корна (разработка компании Free Software Foundation).

POSIX (Portable Operating System Interface for Computer Environments) — набор стандартов описания интерфейсов взаимодействия операционной системы и прикладных программ. Стандарты POSIX разработаны комитетом IEEE (Institute of Electrical and Electronics Engineers) для обеспечения совместимости различных UNIX/Linux-подобных операционных систем и переносимости прикладных программ на уровне исходного кода. POSIX-совместимые оболочки разработаны на базе оболочки Корна.

# Выполнение лабораторной работы

Описываются проведённые действия, в качестве иллюстрации даётся ссылка на иллюстрацию (рис. [-@fig:001]).

![Название рисунка](image/placeimg_800_600_tech.jpg){#fig:001 width=70%}

Даю права на выполнение командой chmod +x lab12.sh

1. Скрипт, который делает резервную копию самого себя в архиве

```
#!/bin/bash

# Создание директории backup в домашнем каталоге, если её нет
mkdir -p "$HOME/backup"

# Формирование имени архива с датой и временем
timestamp=$(date +"%Y%m%d_%H%M%S")
script_name=$(basename "$0")
backup_name="$script_name-$timestamp.tar.gz"

# Копирование скрипта и архивация в tar.gz
tar -czf "$HOME/backup/$backup_name" "$0"

# Вывод сообщения о созданной резервной копии
echo "Резервная копия скрипта создана: $HOME/backup/$backup_name"
```

Описание:

Создание директории backup — создаёт каталог для хранения резервных копий.

Формирование имени архива — создаёт имя файла с уникальным временем для предотвращения перезаписи.

Копирование и архивация — копирует скрипт и архивирует его в формате tar.gz.

Вывод сообщения — информирует пользователя о завершении операции.

2. Скрипт, который обрабатывает любое число аргументов и выводит их

```
#!/bin/bash

# Вывод количества переданных аргументов
echo "Передано $# аргументов:"

# Перебор и вывод каждого аргумента
count=1
for arg in "$@"; do
  echo "Аргумент $count: $arg"
  ((count++))
done
```

Описание:

Вывод количества аргументов — отображает количество переданных аргументов.

Перебор и вывод аргументов — поочередно выводит каждый аргумент с порядковым номером.

3. Скрипт — аналог команды ls (без использования ls и dir)

```
#!/bin/bash

# Установка директории для работы (по умолчанию текущая)
directory="${1:-.}"

# Проверка существования директории
if [ ! -d "$directory" ]; then
  echo "Каталог не найден: $directory"
  exit 1
fi

# Перебор файлов в указанной директории и вывод информации
for file in "$directory"/*; do
  if [ -e "$file" ]; then
    perms=$(stat -c "%A" "$file")  # Получение прав доступа
    size=$(stat -c "%s" "$file")   # Получение размера файла
    name=$(basename "$file")       # Получение имени файла
    echo "$perms  $size байт  $name"  # Вывод информации о файле
  fi
done
```

Описание:

Установка директории — задаёт директорию для работы (по умолчанию текущая).

Проверка существования директории — проверяет, существует ли указанная директория.

Перебор файлов — перебирает все файлы в директории, выводит права доступа, размер и имя каждого файла.

4. Скрипт, который считает файлы с заданным расширением в указанной директории

```
#!/bin/bash

# Проверка аргументов командной строки
if [ $# -ne 2 ]; then
  echo "Использование: $0 <формат_файла> <путь_к_директории>"
  echo "Пример: $0 .txt /home/user/documents"
  exit 1
fi

# Задание переменных для расширения и директории
extension="$1"
directory="$2"

# Проверка существования директории
if [ ! -d "$directory" ]; then
  echo "Директория не существует: $directory"
  exit 1
fi

# Подсчёт файлов с заданным расширением в директории
count=$(find "$directory" -type f -name "*$extension" | wc -l)

# Вывод результата подсчёта
echo "Файлов с расширением $extension в $directory: $count"
```

Описание:

Проверка аргументов — проверяет количество переданных аргументов и выводит ошибку, если их не два.

Задание переменных — сохраняет расширение файла и путь к директории.

Проверка существования директории — проверяет, существует ли указанная директория.

Подсчёт файлов — с помощью find ищет файлы с нужным расширением и считает их количество.

Вывод результата — информирует пользователя о количестве найденных файлов.

# Ответы на контрольные вопросы

1. Что такое командная оболочка? Примеры и различия
Командная оболочка (shell) — это программа, позволяющая пользователю взаимодействовать с операционной системой с помощью командной строки. Она интерпретирует команды пользователя и запускает соответствующие программы.

Примеры оболочек:

+ sh (Bourne Shell) — базовая оболочка UNIX.

+ bash (Bourne Again Shell) — улучшенная версия sh, популярная в Linux.

+ csh (C Shell) — использует C-подобный синтаксис.

+ ksh (Korn Shell) — сочетает черты sh и csh.

+ zsh — расширенная оболочка с поддержкой автодополнения и расширений.

Различия:

+ Синтаксис и доступные функции (например, история команд, работа с массивами, автодополнение)

+ Поддержка расширенных возможностей и скриптов

2. Что такое POSIX?
POSIX (Portable Operating System Interface) — это набор стандартов, разработанных IEEE, обеспечивающих совместимость между UNIX-подобными операционными системами на уровне исходного кода.

POSIX описывает:

+ Поведение оболочек.
+ Стандартные команды.
+ Системные вызовы и API.

3. Как определяются переменные и массивы в bash?

Переменные:

```
name="Alice"
echo $name
```

Массивы:

+ array=(one two three)
+ echo ${array[0]}        # one
+ echo ${array[@]}        # one two three

4. Назначение операторов let и read

let — выполняет арифметические операции:
let a=5+3

read — считывает ввод пользователя:
read name
echo "Привет, $name"

5. Арифметические операции в bash

В bash доступны:

Сложение: +

Вычитание: -

Умножение: *

Деление: /

Остаток от деления: %

Инкремент/декремент: ++, --

Сравнения: ==, !=, <, >, <=, >=

6. Что означает операция (( ))?

(( выражение )) — конструкция для выполнения арифметических вычислений.

Пример:
((a=3+5))
echo $a   # 8

Также может использоваться как условие:
if ((a > 5)); then echo "Больше 5"; fi

7. Стандартные имена переменных bash

$HOME — домашняя директория пользователя.

$USER — имя пользователя.

$PWD — текущая директория.

$PATH — пути поиска исполняемых файлов.

$SHELL — путь к текущей оболочке.

$HOSTNAME — имя хоста.

8. Что такое метасимволы?

Метасимволы — специальные символы, которые имеют особое значение в оболочке:

* — любое количество любых символов.

? — любой один символ.

[] — любой символ из указанного набора.

$, &, |, >, <, ;, (), {} и другие — служебные символы.

9. Как экранировать метасимволы?

Используй обратный слеш \ или заключи в кавычки:

echo \$HOME       # выведет $HOME, а не значение переменной
echo "*file*"     # кавычки предотвратят расширение по шаблону

10. Как создавать и запускать командные файлы?

Создадим файл с расширением .sh, например:
nano myscript.sh

Напишем команды в bash внутри.

Сделаем файл исполняемым:
chmod +x myscript.sh

Запустим:
./myscript.sh

11. Как определяются функции в bash?

my_function() {
  echo "Это функция"
}

Вызов: my_function
12. Как узнать, является ли файл каталогом или обычным файлом?

if [ -d "путь" ]; then
  echo "Это каталог"
elif [ -f "путь" ]; then
  echo "Это файл"
fi

13. Назначение команд set, typeset, unset

set — устанавливает параметры оболочки или выводит переменные.

typeset — (в некоторых оболочках) управляет атрибутами переменных.

unset — удаляет переменные или функции:

unset myvar

14. Как передаются параметры в командные файлы?

Аргументы передаются через специальные переменные:

$1, $2, … — позиционные параметры.

$@ — все аргументы по отдельности.

$# — количество аргументов.

Пример:
+ echo "Первый аргумент: $1"
+ echo "Всего аргументов: $#"

15. Специальные переменные bash и их назначение

Переменная	Назначение
$0	Имя скрипта
$1..$9	Позиционные аргументы
$#	Количество аргументов
$@	Все аргументы как отдельные слова
$*	Все аргументы как одна строка
$?	Код возврата последней команды
$$	PID текущего процесса
$!	PID последнего фонового процесса

# Выводы

Были изучены основы программирования в оболочке ОС UNIX/Linux. Были получены знания о написании небольших командных файлов.


# Список литературы{.unnumbered}

1. [Курс на ТУИС](https://esystem.rudn.ru/course/view.php?id=113)
